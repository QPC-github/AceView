#About the new SEQC main file deposited on SAS September 4, 2012. 
#Table content: Rows:This table includes 61,991 human genes and 92 ERCC sequences, one gene per row. There are 55,772 AceView 2010 genes (annotated at NCBI www.aceview.org). 23,324 of these genes are ‘official' Entrez genes, with RefSeq annotated transcripts, the other 32,448 are annotated in AceView only, as they had no official Entrez gene and no RefSeq as of 2010. AceView genes are complemented by 6,219 RefSeq 2012 genes, which were not represented in AceView2010, or are fused. Indeed, 1,421 human AceView2010 genes have multiple geneIDs, because a long cDNA sequence in GenBank merged and connected two nearby genes. A gene merging two official genes named A and B (not LOC#) is called gene 'Aand B' in AceView. 
#The genes are sorted by descending index of expression, taking for each gene its maximal index across all runs and groups in the table. The first numerical column (number 12), called ‘SumOfAllReadsInProject‘ gives the index of the gene computed by summing all mapped reads in all 2,759 individual runs. To sort using the sum across all runs of all reads mapping in the genes, reorder on the first numerical column, called "SumOfAllReadsInProject".
#In the top of the table, the first numerical line gives the ‘low measurable index’ in the run, defined as the index for which there are as many NA values above than non-NA values below. This line may be useful when addressing the NA calls in this table (see below)
#Columns: For each gene (named in column 1), in a given annotation (column 2), the NCBI GeneID is provided (Column 3). Note that genes not officially annotated do not have a geneID, and some AceView genes have 2 or more GeneIDs, as explained above. 
#The RefSeq transcript ID(s) are given in column 4 (from Aug 28, 2012 Gene2RefSeq file at NCBI). Then to allow comparison to microarray datasets used in MAQC1, the Affymetrix probeset ID(s) we uniquely re-mapped to the gene in column 1 is provided in column 5: 44,686 probesets map to 22,460 AceView2010 genes; 10,554 genes have multiple probesets. Col 6 to 9 give the chromosome, strand, and start and end coordinates of the AceView genes on the genome.Col 10 gives the descriptive gene title, from the AceView databaseCol 11 summarizes the object measured (gene name and annotation of origin). Column 12 is the first numerical column, called 'SumOfAllReadsInProject', it gives the expression index for each gene when adding all reads mapped to the gene in all 123 runs. 
#The following columns show the index of expression of each gene, per each of 2,759 runs, named by their official identifier (or by their internal identifier Rhs#), then for each of 449 groups. Beware; the 2,759 individual runs include 51 LIV LIF runs, done however using a different technique. Then come the 449 groups, from large to small, grouping multiple runs in a logical way, by platform/site/sample/library/flowcell/lane. The names of large groups start with A0, A1, A, B, C, D, E, F_ allowing alphabetic sorting. The 208 next groups correspond to the 208 libraries made and sequenced. They start by I, L, or R_ for Illumina, LifeTech or Roche, followed by the 3 letter site_, followed by the sample(s) (A B C D E F), then by the number of the library (usually 1 to 5, 5 being made by the constructor, Gary Schroth at Illumina or Bob Setterquist at LifeTech), then the number of pooled runs. Similar naming rules apply to the larger groups (please ask if some names are unclear).For homogeneous groups measuring the #same sample in distinct lanes, flowcells, libraries or sites, the index was computed by adding the reads from the individual runs in the group, giving large coverage and very small sampling errors, even for low expressed genes. For heterogeneous groups, such as those measuring the index of expression of a variety of samples (in large groups of type A_ or C_, or for runs pooled in a given flowcell and lane, class E_), the average of the indexes across the pooled runs was computed. E_ groups are mostly useful to demonstrate the impact of the flowcell/lane on the coherence of the position of mismatches at particular sequencing cycles, and the specific type of mismatches associated to these spikes.  
#NA values:   Genes that are not "significantly expressed", i.e. with less than 4 reads above the experimental noise level, acquire an NA/ flag. As of August 28, 2012, since it is hard to deal with absent values (e.g. to compute an average or to extract meaningful differentially expressed genes), a value is now given behind the NA/ as a hint of the unreliably measured index (inaccurate because based on too few counts and dominated by sampling errors). 
#To treat NA, there are three options:  one may either blank out the absent values identified by NA, 	or take the hint value behind NA (not too seriously), 	or use a common value for NA in each run: we propose to use the number given in the first numerical line of the table, called "Lowest measurable index", minus 1 .  Thanks to David Kreil, Peter and Pawel from Boku for testing the three methods. 
#If we focus on the 52,769 AceView genes expressed in at least one SEQC ABCD run, 65 million are called expressed while 92 million are NA/# calls.   Altogether, many measures in the table are NA, as individual multiplexed runs are not deep, and some genes appear expressed in Brain but not cultured cells and vice versa. Also, some genes in this table (3,300 AceView genes, of which 1,182 have a geneID and 361 RefSeq genes) are 'not significantly expressed' - or NA - in any of the brain or cultured cells runs, although a few reads, that we interpret as background noise, may have been occasionally seen (when a non-zero number follows the NA/).  
#Choice of genes: AceView 2010 genes integrate and summarize all 9 million human cDNA sequences in GenBank, dbEST, Trace and RefSeq NM/NR transcript models from August 2010. They include all Entrez genes from 2010. Official Entrez gene names are used when available; otherwise genes are named using an AceView name, maintained stable across releases since 2001.  Human cDNA sequences in GenBank define about twice as many genes and close to twice as many exon junctions (370,000, to be compared to 198,000 in RefSeq 2012) than annotated in RefSeq/Entrez official genes. AceView annotates 207,928 spliced transcript variants, that is 7 times more alternatively spliced variants than in RefSeq.  
#Mapping strategy:   We use our Magic RNAseq aligner and pipeline. Read pairs are mapped in parallel on multiple targets, and the quality of the alignments is compared to select the best alignments. All best alignments are then submitted to a stringent quality filter. Specificity of the mapping is monitored using the ‘imaginary genome’, ie the genome of the species where all A and T, and all G and C were simply exchanged, making it completely alien, as only short stretches of RNAseq map to this genome, yet respecting letter statistics at all scales. Targets used in this project were the AceView 2010 transcripts, the RefSeq, the genome, the mitochondria, the ribosomal RNAs, the ‘RNA genes’ from S. Eddy, the ERCC and PhiX controls, and the imaginary genome as a mapping specificity control. At the end of the process, all reads are accounted for: in SEQC_main, we mapped 99.7% of the Roche reads, 98% of the Illumina reads, and 54.6% of the LifeTech reads.  
#92.1% of the sample B brain reads, and 93.2% of the sample A cells map to previously annotated genes. Using AceView rather than RefSeq allows mapping 7.8% more reads to annotated genes and to improve the quality of the alignments. In the SEQC main project, 26.32 billion reads, or 2.42 terabases are aligned in genes and used to compute this expression index table (which omits the ribosomal and mitochondrial genes). 
#Magic alignments on the genome can be discontinuous, allowing for exon-junctions discovery; they may include substitutions, short insertions or deletions, but not closer than 8 bases from either end of the read, otherwise the alignment is clipped before the mismatch to avoid extending alignments within introns. The eventual adaptor sequences and poly A tails are trimmed dynamically during the alignment, verifying that the trimmed part does not match the target genome or gene. Finally, the best targets for each read-pair are selected, and only read mapping well and at their best score in the AceView or RefSeq transcripts are used to compute the gene indexes in this table.   Genes often have alternative transcripts, to which the reads map equally well; such reads count as uniquely mapped in the gene, and each gene receives the union (not the sum) of all reads mapping to its alternative transcripts. 
#0.81% of all aligned reads in SEQC map equally well in up to 9 genes: they are attributed to the candidate genes in Bayesian proportion of the number of reads mapping uniquely to these genes. (a similar table limited to uniquely mapping reads, is available on request).  Note that, for equal quality alignments, a slight penalty was given to unspliced genes relative to spliced ones at the best-targets selection step, and this avoids over-annotating recent pseudogenes. 
#Normalization: the Magic expression index
#The Magic expression index for the gene is measured as the log base 2 of the number of bases aligned in the gene, divided by the number of terabases aligned in known genes and by the length of the gene, with several corrections. When a gene is reliably measured (i.e. not NA), the index is independent of the size of the experiment; it factors in the quality of the libraries, the insert length and the noise level. Because of the stringent quality filter imposed on the alignments, the noise is mainly genomic contamination, evaluated as the fraction of truly intergenic reads after transcriptome reconstruction. Our index is directly comparable to a normalized microarray logarithmic luminosity. 
#Genes that are not "significantly expressed", i.e. with less than 4 reads above the experimental noise level, acquire an NA/ flag. For significantly expressed genes, the expression index is measured as Index = log2 (z+ sqrt(1+z^2))-1, with z = 10^12 n/N'l'
# z estimates the coverage of the gene per terabases aligned,  n is the number of bases aligned in the gene,  N' /10^12 is the corrected number of terabases aligned to the AceView genes with GeneID, after excluding the ribosomal and mitochondrial genes and the genes gathering more than 2% of the total number of bases aligned (in rat liver TGx, often the genes Alb, Ehhadh, Trf), to compensate an apparent variation of all indexes in the presence of highly-variable extremely-expressed genes.  l' is the length of the gene effectively sequenceable in the particular experiment, which is limited in polyA selected libraries by the maximal length of the cDNA synthesis, and constrained by the insert length: genes shorter than insert size cannot be sequenced. In practice, the coverage of very long ubiquitous genes (such as EEF2 (3.5kb), FLNA (8.5 kb), MALAT1 (7kb), AHNAK (18 kb) or NEAT (22 kb)) is measured and used as a maximal gene length. 
#This length is usually below 3 kb for a polyA selection protocol; it corresponsmainly to the 3' bias. Second, the average length lambda of the insert is measured by aligning the read pairs, and subtracted from the length of the main RNA l. Indeed l'= (l – lambda) is the number of possible positions of the insert in the gene; l' is set to at least lambda. This correction matters for short genes, under-represented in libraries with long insert size.

