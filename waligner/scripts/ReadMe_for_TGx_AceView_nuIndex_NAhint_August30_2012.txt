#About the new rat TGx file deposited on NIEHS sharepoint August 30, 2012. 
#Table content: 1 Rows:This table includes 46,002 genes, one gene per row. There are 40,669 AceView 2008 genes (annotated at NCBI www.aceview.org). 19,940 of these genes are ‘official' Entrez genes, with RefSeq annotated transcripts, the other 20,729 are annotated in AceView only, as they had no official Entrez gene and no RefSeq as of 2008. AceView genes are complemented by 5,333 RefSeq 2012 genes, which were not represented in AceView2008, or are fused. Indeed, 242 AceView2008 genes have multiple geneIDs, a gene merging two official genes named A and B is called gene 'A and B' in AceView. 
#The genes are sorted by descending index of expression, taking for each gene its maximal index across the 123 TGx runs. To sort using the sum across all runs of all reads mapping in the genes, reorder on  the first numerical column, called "SumOfAllReadsInProject".The first numerical line gives gives the ‘low measurable index’ in the run defined as the index for which there are as many NA values above as non-NA values below. This line may be useful when addressing NA calls (see below)
#2- Columns: For each gene (named in column 1), in a given annotation (column 2), the NCBI GeneID is provided (Column 3). Note that genes not officially annotated do not have a geneID, and some AceView genes where cDNA sequences in GenBank merged and connected two nearby genes have 2 or more GeneIDs. The RefSeq transcript ID(s) are given in column 4 (from Aug 29, 2012 Gene2RefSeq file at NCBI). Then to allow comparison to microarray datasets used in TGx, the Affymetrix probeset ID we uniquely re-mapped to the gene in column 1 is provided in column 5 (23,336 probesets map to 17,898 AceView2008 genes; 4,077 genes have multiple probesets). The number of uniquely mapped probe in each probeset is given in parenthesis. Col 6 to 9 give the chromosome, strand, and start and end coordinates of the AceView genes on the genome. Col 10 gives the descriptive gene title, from the AceView database. Col 11 summarizes the object measured (gene name and annotation of origin). 
#Column 12 is the first numerical column, called 'SOfAllReadsInProject', it gives the expression index for each gene when adding all reads mapped to the gene in all 123 runs. 
# The following columns show the gene index of expression, per each of 123 runs, named by their official COH_WANG identifier. For convenience, the Affymetrix experiment number is indicated when known. 
# NA values: Genes that are not "significantly expressed", i.e. with less than 4 reads above the experimental noise level, acquire an NA/ flag. As of August 28, 2012, since it is hard to deal with absent values (e.g. to compute an average or extract meaningful differentially expressed genes, a value is now given behind the NA/ as a hint of the unreliably measured index (inaccurate because based on too few counts to be accurate and dominated by sampling errors). To treat NA, there are three options:	one may either blank out the absent values, or take the hint value behind NA (not too seriously), or use a common value for NA in each run: we like the number given in the first numerical line of the table, called "Low measurable index", minus 1 (Thanks to David Kreil, Peter and Pawel from Boku for testing the three methods). 
# Note that a number of genes in this table are 'not significantly expressed' or NAin all TGx liver runs (4,938 RefSeq genes, and 8,451 AceView genes). Altogether, 2.2 million measures  in the table are NA, but once we remove the 13,389 genes not expressed in any liver sample, we are left wit 594k NA out of 4,180k measures in 33,713  genes: the frequency of NA in genes expressed in at least one lier TGx sample is 14.2%.  
# Choice of genes: AceView 2008 genes integrate and summarize all 940,000 human cDNA sequences in GenBank, dbEST and RefSeq NM/NR transcript models from September 2008. They include all Entrez genes from 2008. Entrez gene names are used when available, otherwise genes are named using an AceView name, stable across releases. Rat cDNA sequences in GenBank define about twice as many genes, with about the same number of exon junctions (174,000). AceView annotates 45,025 spliced transcript variants, i.e. about twice more alternatively spliced variants than in RefSeq.  
#Mapping strategy: We use our Magic RNAseq aligner and pipeline. 
#Read pairs are mapped in parallel on multiple targets, and the quality of the alignments is compared to select the best alignments; all best alignments are then submitted to a stringent quality filter, specificity of the mapping is monitored using the ‘imaginary genome’, ie the genome of the species where all A and T, and all G and C were simply interchanged . Targets were the AceView 2008 transcripts, the RefSeq, the genome, the mitochondria, the ribosomal RNAs extracted from GenBank, the ERCC and PhiX controls, and the imaginary genome as a mapping specificity control. At the end of the process, all reads are accounted for: in human Illumina or Roche RNAseq data, we usually map over 99% of all reads to genes or genome. In rat, the genome is of lesser quality and is missing an estimated 3 to 4% of the transcribed gene sequences. 
#In the TGx 111 runs with both forward and reverse reads, 96.83% of the reads are well-mapped, and those  mapping to AceView or RefSeq 2008 nuclear genes were used to compute this gene index table; these are 4.12 billion reads, or 393 gigabases of data, not counting the ribosomal or mitochondrial. Alignments on the genome can be discontinuous, allowing for exon-junctions discovery; they may include substitutions, short insertions or deletions, but not closer than 8 bases from either end of the read, otherwise the alignment is clipped before the mismatch. The eventual adaptor sequences and poly A tails are trimmed dynamically during the alignment, verifying that the trimmed part does not match the target genome or gene. Finally, the best targets for each read-pair are selected, and only read mapping well and at their best score in the AceView or RefSeq transcripts are used to compute the gene indexes in this table. 
#Genes often have alternative transcripts, to which the reads map equally well; such reads count as uniquely mapped in the gene, and each gene receives the union (not the sum) of all reads mapping to its alternative transcripts. Reads mapping equally well in up to 9 genes are attributed to the candidate genes in Bayesian proportion of the number of reads mapping uniquely to these genes (a similar table limited to uniquely mapping reads, is available on request).
#Normalization: the Magic expression index: The Magic expression index for the gene is measured as the log base 2 of the number of bases aligned in the gene, divided by the number of terabases aligned in known genes and by the length of the gene, with several corrections. When a gene is reliably measured (i.e. not NA), the index is independent of the size of the experiment; it factors in the quality of the libraries, the insert length and the noise level. Because of the stringent quality filter imposed on the alignments, the noise is mainly genomic contamination, evaluated as the fraction of truly intergenic reads after transcriptome reconstruction. Our index is directly comparable to a normalized microarray logarithmic luminosity. 
# Genes that are not "significantly expressed", i.e. with less than 4 reads above the experimental noise level, acquire an NA/ flag. As of August 28, 2012, since it is hard to deal with absent values (e.g. to compute an average or extract meaningful differentially expressed genes, avalue is now given behind the NA/ as a hint of the unreliably measured index (inaccurate because based on too few counts to be accurate and dominated by sampling errors). To treat NA, there are three options: one may either blank out the absent values, or take the hint value behind NA (not too seriously), or use a common value for NA in each run: we like the number given in the first numerical line of the table, called "Low measurable index", minus 1 (Thanks to David Kreil, Peter and Pawel from Boku for testing the three methods). 
#	For significantly expressed genes, the expression index is measured as Index = log2 (z+ sqrt(1+z^2))-1, with z = 10^12 n/N'l'
# z estimates the coverage of the gene per terabases aligned,  n is the number of bases aligned in the gene,  N' /10^12 is the corrected number of terabases aligned to the AceView genes with GeneID, after excluding the ribosomal and mitochondrial genes and the genes gathering more than 2% of the total number of bases aligned (in rat liver TGx, often the genes Alb, Ehhadh, Trf), to compensate an apparent variation of all indexes in the presence of highly-variable extremely-expressed genes.  l' is the length of the gene effectively sequenceable in the particular experiment, which is limited in polyA selected libraries by the maximal length of the cDNA synthesis, and constrained by the insert length: genes shorter than insert size cannot be sequenced. In practice, the coverage of very long ubiquitous genes (such as EEF2 (3.5kb), FLNA (8.5 kb), MALAT1 (7kb), AHNAK (18 kb) or NEAT (22 kb)) is measured and used as a maximal gene length. 
#This length is usually below 3 kb for a polyA selection protocol; it corresponsmainly to the 3' bias. Second, the average length lambda of the insert is measured by aligning the read pairs, and subtracted from the length of the main RNA l. Indeed l'= (l – lambda) is the number of possible positions of the insert in the gene; l' is set to at least lambda. This correction matters for short genes, under-represented in libraries with long insert size.

